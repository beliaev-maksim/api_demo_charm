# Copyright 2022 maksim
# See LICENSE file for licensing details.

# For a complete list of supported options, see:
# https://juju.is/docs/sdk/metadata-reference
name: demo-api-charm
display-name: |
  demo-fastapi-k8s
description: |
  This is a demo charm built on top of a small Python FastAPI server.
  This charm could be related to PostgreSQL charm and COS Lite bundle (Canonical Observability Stack).
summary: |
  FastAPI Demo charm for Kubernetes

requires:
  database:
    interface: postgresql_client
    limit: 1
  logging:
    interface: loki_push_api
    limit: 1

provides:
  metrics-endpoint:
    interface: prometheus_scrape
  grafana-dashboard:
    interface: grafana_dashboard


# containers for the workload (delete for non-k8s)
containers:
  demo-server:
    resource: demo-server-image

# each container defined above must specify an oci-image resource
resources:
  demo-server-image:
    type: oci-image
    description: OCI image from GitHub Container Repository
    upstream-source: ghcr.io/beliaev-maksim/api_demo_server:0.0.5
